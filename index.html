<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>BSA Dashboard</title>
  <style>
    * { box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f4;
    }

 #dashboard {
   top: 20px;
  padding: 3px;
  min-height: 85vh;
  background-color: rgb(209, 238, 247);

}


   .section {
  border: 1px solid #ccc;
  padding: 15px;
  margin-top: 0; /* 🔧 Changed from 5px to 0px */
  background-color: #ffffff;
  border-radius: 6px;
}



#sections {
  position: fixed;
  top: 40px; /* 1 inch from top */
  left: 0;
  right: 0;
  bottom: 0; /* allows full height scrolling inside */
  overflow-y: auto; /* only inner content scrolls */
  padding: 1px;
  background-color: #e9f7fc;
}

    .message {
      color: red;
      margin-top: 15px;
    }

    .hidden {
      display: none;
    }

    h2 span {
      color: #004466;
    }

    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background-color: #f9fafa;
      padding: 5px 10px;
      z-index: 1000;
    }

    #top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 2px;
      background-color: #026186;
      color: white;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 999;
    }

    .button-div {
      display: flex;
      overflow-x: auto;
      white-space: nowrap;
      gap: 1px;
    }

    .button-div button {
      flex: 0 0 auto;
      min-width: 200px;
      padding: 10px 10px;
      background-color: #026186;
      color: white;
      border: none;
      border-radius: 0px;
      cursor: pointer;
      font-size: 18px;
    }

    .button-div button:hover {
      background-color: #01384e;
      color: rgb(233, 248, 26);
    }

    #logout-btn {
      background-color: #f44336;
      color: white;
      border: none;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
    }

    #logout-btn:hover {
      background-color: #e53935;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 16px;
      background-color: rgb(8, 8, 8);
      color: white;
      border: 1px solid rgb(1, 45, 75);
      border-radius: 4px;
      padding: 0 10px;
    }

    #username {
      font-size: 20px;
      font-weight: bold;
      color: rgb(243, 243, 242);
    }





 /* 30%-70% div Style start  */

     .twopartdiv {
            display: flex;
           

            flex-direction: row; /* Arrange child divs side-by-side (flex-direction: column;) */

          /*  flex-direction: column;  Arrange child divs vertically */
            height: 80vh; /* Full viewport height */
        }
      .left {
      flex: 2; /* 70% */
      background-color: #dddedf;
      border: 7px solid #004d80;
      padding: 10px;
      z-index: 99;
      overflow-y: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      border-radius: 8px;
    
}

.right {
    flex: 8; /* 30% */
   background-color: #dddedf;
    
      padding: 10px;
      z-index: 99;
      overflow-y: auto;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
      border-radius: 8px;
}

/* 30%-70% div Style stop  */





/* Base table style */
 table {
  width: 100%;
  margin-top: 20px;
  border-collapse: collapse;
  border-radius: 8px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  font-size: 14px;

}

th, td {
  border: 1px solid #e0e0e0;
  padding: 10px 14px;
  text-align: left;
}

th {
  background-color: #004d80;
  color: white;
  font-weight: bold;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

tr:nth-child(even) {
  background-color: #f9f9f9;
}

table tr:hover {
  background-color: #f5ea88;
  color: rgb(0, 30, 58);
  transition: background-color 0.3s ease, color 0.3s ease;
 
}

/* footer Styling start */

  .footer {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background-color: #026186;
  padding: 4px;
  z-index: 1000;
}




  </style>
</head>
<body>

 

  <div id="dashboard">  <!-- Dashboard div start -->
    <header>
      <div id="top-bar">

      <div class="button-div">
      <button onclick="showSection(1)">HOME</button>
      <button onclick="showSection(3)" style="color: rgb(249, 172, 172);">Class Corner</button>
      <button onclick="showSection(2)">Marksheet View</button>
      <button onclick="showSection(5)">Transfer Certificate (TC)</button>
      <button onclick="showSection(4)">Admin*</button>
      </div>

        <div class="user-info">
          <span id="username">Guest</span>
          <button id="logout-btn" onclick="logout()">Logout</button>
        </div>
      </div>
    </header>

    <div style="height: 60px;"></div> <!-- spacer under header -->

    <div id="message" class="message"></div>

    <!-- ============================================== sections start =============================================================== -->

  <div id="sections">  <!-- sections Div open-->

     <div id="sectionGuest" class="section hidden">
  <h2><span>Welcome Guest</span></h2>
  <p>You are logged in as a guest. Limited access.</p>



</div>

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->
  
<!-- SECTION (1) START -->  <div id="section1" class="section hidden" >
  <h3><span>HOME</span> Section</h2>

<h1 style="color:#2F4F4F;text-align:center;font-size:150%">
<span style="color:#022d5e;font-size: 150%;">BABA SCHOLAR'S ACADEMY</span>
</h1>

 <h1 style="color:rgb(2, 172, 172); text-align: center; font-size: 100%;">Near PNB Bank, Kundeshwari, Kashipur<br/> (U.S.Nagar) Uttarakhand-244713 </h1>
<h1 style="color:#2F4F4F;text-align:center;font-size:100%">
<span style="color:#848585;font-size: 100%;">Contect No ☎ : 9389668204, 8279808172</span>
<span style="color:#616060;font-size: 100%;">A Co-Educational English Medium School (Aff No. RTE65879)</span>
</h1>








        

<style>

  .homesection {
      padding: 40px 20px;
      max-width: 1200px;
      margin: auto;
    }

      .services {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
    }
 
.card {
      background: #fff;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
      padding: 20px;
      margin: 10px;
      width: 350px;
      border-radius: 8px;
    }
</style>



  <section class="homesection" >
    <h2>Dashboard</h2>
    <div class="services">

      <div class="card">
 
   <strong style="color: #003636; font-weight: bold;">Principal: </strong> Madhu Ghildiyal
 <p>Admin Details: Mr. Mukhtiyar Ahamad <br/> Contect No: +91-9756735792</p>
      </div>

      <div class="card">
      <div id="birthdayDiv">
         <span style="color:#012929;font-size:110%;">Today's Birthdays</span>
         <ul id="birthdayList"> </ul> </div>
      </div>

      <div class="card">
       <div id="eventsList" style="color:#013030;font-size:100%;font-family:Arial;"></div>
       
      </div>

    </div></section>






</div> <!-- SECTION (1) STOP -->

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->



<div id="section1b" class="section hidden" style="background-color: #01293c; padding: 10px; color: rgb(1, 40, 71); font-family: 'Segoe UI', sans-serif; box-shadow: 0 0 10px rgba(0,0,0,0.3); border-radius: 10px; margin: 10px auto; max-width: 100%;">
<img style="width:320px; height:230px; align:center; border: 5px solid #013a3e;" src="https://babascholarsacademy.in/wp-content/uploads/2023/02/8503a649-210e-42d0-b319-1cf97ea98633-1024x681.jpg" />
<img style="width:320px; height:230px; align:center; border: 5px solid #013a3e;" src="https://babascholarsacademy.in/wp-content/uploads/2023/02/IMG-20221112-WA0193.jpg" />
<img style="width:320px; height:230px; align:center; border: 5px solid #013a3e;" src="https://babascholarsacademy.in/wp-content/uploads/2023/02/6529f90b-feae-401b-ad37-4fee3818010a-1-1024x681.jpg" />
<img style="width:320px; height:230px; align:center; border: 5px solid #013a3e;" src="https://babascholarsacademy.in/wp-content/uploads/2023/02/IMG-20221112-WA0023.jpg" />
<img style="width:320px; height:230px; align:center; border: 5px solid #013a3e;" src="https://babascholarsacademy.in/wp-content/uploads/2023/08/55ace655-c445-4899-9eed-1964e16621ff-1024x682.jpg" />
<img style="width:320px; height:230px; align:center; border: 5px solid #013a3e;" src="https://babascholarsacademy.in/wp-content/uploads/2023/02/IMG_20230226_102344.jpg" />

</div>
<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->



<!-- SECTION (2) START --> <div id="section2" class="section hidden">
 
  
   <div class="twopartdiv">  <div class="left" style="background-color: #edeeef; color:#004d80;font-weight: bold;">   <!-- यह एक नोट है, vertical Two Part Div (30-70) left content start -->



    

<span style="color:#940227;font-size:120%;font-family:Arial Black;">Student Report Card </span> <br/>
        <!-- Input Form -->
        <div class="formBSAcontainer">
            <label for="BSAsession">Select Session*:</label>
            <select id="BSAsession" name="Type1" required onchange="updateBSADropdown()">
                <option value="2024-25">2024-25</option>
                <option value="2025-26">2025-26</option>
                <option value="2023-24">2023-24</option>
            </select>
            
            <label for="clasBSAswise">Select Class*:</label>
            <select id="clasBSAswise" name="Type" required onchange="updateBSADropdown()">
                <option value="">-- Select Class --</option>
                <option value="Pre-Nursery">Pre-Nursery</option>

                <option value="NURSERY - A">Nursery - A</option>
                <option value="NURSERY - B">Nursery -B</option>
                <option value="LKG - A">LKG - A</option>
                <option value="LKG - B">LKG -B</option>
               
                <option value="UKG">UKG (23-24)</option>
                    <option value="UKG - A">UKG-A (24-25)</option>
                    <option value="UKG - B">UKG-B (24-25)</option>
                
                <option value="1st">1st</option>
                <option value="2nd">2nd</option>
                
                <option value="3rd">3rd</option>
                <option value="4th">4th</option>
                <option value="5th">5th</option>
            </select>
            
            <label for="aBSAEno">Admission No:</label>
            <select id="aBSAEno" required onchange="MarkBSAEsheet()">
                <option value="">Select Admission No</option>
            </select>
            
            
            <p class="error" id="error-message"></p>

            <span id="totalBSAStudents"></span>
        </div>
    
        
        <div id="topBSAStudent" style="margin-top: 10px; font-weight: bold; color: green;"></div>


</div> <!-- यह एक नोट है, vertical Two Part Div (30-70) left content stop -->

<div class="right"  style="background-color: #fbfbfc; color:#004d80;"> <!-- यह एक नोट है, vertical Two Part Div (30-70) right content start -->

    <!-- Marksheet View -->
        <div id="marksheetE-BSAviewer" class="MarkBSAEsheet">
            <button id="printBSAButton" onclick="sheetBSAdataPrint()" style="margin-bottom: 20px; padding: 8px 16px; font-size: 16px;">🖨️ Print Marksheet</button>
            <div id="marksheetE-BSAview"></div>
           <BR/><BR/><BR/><BR/>
        </div>

  </div> </div>  <!-- यह एक नोट है, vertical Two Part Div (30-70) twopartdiv content stop  Heare -->
</div> <!-- SECTION (2) STOP -->

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->


<!-- SECTION (3B) START -->  <div id="section3b" class="section hidden" style="background-color: #dcdedf; padding: 10px; color: rgb(1, 40, 71); font-family: 'Segoe UI', sans-serif; box-shadow: 0 0 10px rgba(0,0,0,0.3); border-radius: 10px; margin: 10px auto; max-width: 100%;">


  <!-- First dropdown populated based on username -->
 

 <label style="font-size: 20px; font-weight: bold;color: rgb(2, 61, 81);">Select Class:</label>
<select id="CLASSUSER" required onchange="showForm(this.value)" style="width: 3in; font-size: 18px; text-align: center; background-color: #ffffff;color: rgb(1, 32, 42);"></select>

   <span style="color: rgb(2, 61, 81); font-size: 120%; font-weight: bold;">Search Student Details</span>
    <input type="text" id="serchbarSRldgr" placeholder="🔍 Search..." onkeyup="searchSRldgrTable()" style="width: 3in; font-size: 18px; text-align: center; background-color: #eaf2f6;color: rgb(1, 32, 42);">

  </div> <!-- SECTION (3B) STOP -->



<!-- SECTION (3) START --> <div id="section3" class="section hidden">

   <div class="twopartdiv">  <div class="left" style="background-color: #eaeaea; color:#004d80;font-weight: bold;">   <!-- यह एक नोट है, vertical Two Part Div (30-70) left content start ((CODE501)) -->

<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->
 <!-- Right Form Section -->
<label style="font-size: 20px; font-weight: bold;color: rgb(0, 43, 56);">Select Session*</label>
 <select id="SESSIONYEAR"  required style="width: 2in; font-size: 18px; text-align: center; background-color: #464e02;color: rgb(242, 243, 243);" >
        <option value="2024-25">2024-25</option>
        <option value="2025-26">2025-26</option>
        <option value="2023-24">2023-24</option>
    </select>

    <div id="rowCountDisplay" style="margin: 10px 0; font-weight: bold;"></div>
  
  <div id="registerDetails" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

  <br/>
  
<button onclick="printSTUDENTtable()" style="background-color: black;color: white; font-size: 16px;">🖨️ Print</button>
<button onclick="showSection(6)" style="background-color: rgb(1, 53, 67); color: white;font-size: 16px;">Report Card Summry</button>


<!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->  

    </div> <!-- यह एक नोट है, vertical Two Part Div (30-70) left content stop -->
<div class="right" style="background-color: rgb(253, 252, 252);">  <!-- यह एक नोट है, vertical Two Part Div (30-70) right content start -->

 
<div id="classWrapper" style="display: none;"> <table> <thead id="tableHeadSRldgr"></thead>  <tbody id="tableBodySRldgr"></tbody> </table> </div>
<p id="classOPTIONMessage" style="color: rgb(2, 65, 109); text-align: center;font-size: 20px;">Select a Class Option first for Details</p>


    </div> </div>  <!-- यह एक नोट है, vertical Two Part Div (30-70) right content stop -->
</div> <!-- SECTION (3) STOP -->



<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->


<!-- SECTION (4) START --> <div id="section4" class="section hidden">
 
  
  
<!-- यह एक नोट है, Dropdown URL  Script Start Heare -->
<!DOCTYPE html>
<html>
<head>

    <script>
        // Function to handle dropdown selection
        function handleDropdownChange() {
            const dropdown = document.getElementById('linkDropdown');
            const selectedOption = dropdown.options[dropdown.selectedIndex];

            if (selectedOption.value) {
                // Open the link in a new tab
                window.open(selectedOption.value, '_blank');
            }
        }
    </script>
    <style>
        select {
            padding:5px;
            font-size: 14px;
            margin: 2px 0;
        }
    </style>
</head>
<body>

 <label style="color: #000;"> Google Sheet Links</label>
    <select id="linkDropdown" onchange="handleDropdownChange()">
        <option value="">--Google Sheet Links --</option>
        <option value="https://docs.google.com/spreadsheets/d/1BiADwSV64zXPz0UyVmYN7BlyW8DiCylgT3-bSrnIk38/edit?gid=435632414#gid=435632414">	BSA GOOGLE DATA SHEET </option>
        
    </select>
</body>
</html>

<!-- यह एक नोट है, Dropdown URL  Script Stop Heare -->


</div> <!-- SECTION (4) STOP -->

<!-- SECTION (5) START --> <div id="section5" class="section hidden">
 
  
  
<span style="color: rgb(0, 60, 65); font-size: 20px;font-weight: bold;"> Select Student A. No.</span>
  <select id="studentTCDropdown" style=" margin: 10px 0 30px;padding: 6px 10px; font-size: 16px;">
    <option value="">-- Select Admission No. --</option>
  </select>

  <button onclick="printCertificate()" style="margin-bottom: 20px; padding: 8px 16px; font-size: 16px;">🖨️ Print Certificate</button>
    <div id="lastTCNumber" style="margin: 10px 0; font-size: 18px; font-weight: bold; color: green;"></div>

  <div class="certificate"> <!-- TC certificate start-->
    <div class="headerTC">
      <h1>BABA SCHOLAR'S ACADEMY</h1>
      <h2>Kundeshwari Kashipur, District - Udham Singh Nagar (U.K)</h2>
      <p>A Co-Educational English Medium School</p>
      <p>Contact No: 9389668204, 8057678852, 8279808172</p>
      <p>Aff. No.: RTE65879 &nbsp; | &nbsp; UDISE CODE: 05120500110</p>
    </div>

    <div class="titleTC">TRANSFER CERTIFICATE</div>

    <div id="studentTCInfo"></div>

    <div class="signature-section">
      <div class="signature">
        <div class="signature-line"></div>
        <div>Sign of Class Teacher</div>
      </div>
      <div class="signature">
        <div class="signature-line"></div>
        <div>Checked By Principal<br>(Full Name & Designation)</div>
      </div>
    </div>
  </div> <!-- TC certificate stop-->
<br/><br/><br/><br/>

</div> <!-- SECTION (5) STOP -->

<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->



<!-- SECTION (6B) START -->  <div id="section6b" class="section hidden" style="background-color: #d8eaf3; padding: 10px; color: rgb(1, 40, 71); font-family: 'Segoe UI', sans-serif; box-shadow: 0 0 10px rgba(0,0,0,0.3); border-radius: 10px; margin: 10px auto; max-width: 100%;">


 <label for="ReportSummrySession">Select Session*:</label>
    <select id="ReportSummrySession" name="Type1" required onchange="updateRCSDropdown()">
        <option value="2024-25">24-25</option>
        <option value="2023-24">23-24</option>
    </select>
    

<!-- dynamic dropdown class section start -->  
   <label for="ReportClassSummry">Select Class*:</label>
<select id="ReportClassSummry" name="Type" required onchange="updateRCSDropdown()"></select>

<script>
function updateReportClassSummry() {
    const classUserSelect = document.getElementById("CLASSUSER");
    const reportClassSelect = document.getElementById("ReportClassSummry");

    if (!classUserSelect || !reportClassSelect) return;

    // Clear existing options
    reportClassSelect.innerHTML = "";

    // Copy all options from CLASSUSER
    Array.from(classUserSelect.options).forEach(opt => {
        const newOpt = document.createElement("option");
        newOpt.value = opt.value;
        newOpt.text = opt.text;
        reportClassSelect.appendChild(newOpt);
    });
}

// Observe changes in CLASSUSER for dynamic update
const observer = new MutationObserver(() => {
    updateReportClassSummry();
});

// Start observing when DOM is loaded
document.addEventListener("DOMContentLoaded", () => {
    const classUserSelect = document.getElementById("CLASSUSER");
    if (classUserSelect) {
        observer.observe(classUserSelect, { childList: true, subtree: false });
        updateReportClassSummry(); // Initial call
    }
});
</script>
<!-- dynamic dropdown class section stop -->  
    
    <label for="ANOReport">Admission No:</label>
    <select id="ANOReport" required onchange="MarkRCSEsheet()">
        <option value="">Select Admission No</option>
    </select>

     <button id="printBSAButton" onclick="sheetRCSdataPrint()" style="background-color: #0a0a0a;color: white;">🖨️ Print</button>
    
     <div id="totalStudents" style="margin-top: 10px; font-weight: bold;"></div>
    <div id="topStudent" style="margin-top: 10px; font-weight: bold; color: green;"></div>
    <p class="error" id="error-message"></p>

  </div> <!-- SECTION (3B) STOP -->




  <div id="section6" class="section hidden">

<!-- sheetRCSdata body part start-->




<span style="color:#940227;font-size:120%;font-family:Arial Black;">Student Report Card </span> 


<!-- Marksheet View -->
<div id="marksheetE-viewer" class="MarkRCSEsheet">
   
    <div id="marksheetE-view"></div>
   <BR/>
</div>
<!-- sheetRCSdata body part stop-->

</div> <!-- section6 stop-->


<!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ -->

    </div>


<!-- ✅ Footer content start -->
<div class="footer">

  

 <!-- Current date and time will be displayed here -->
            
<meta name="viewport" content="width=device-width, initial-scale=1.0">
            
<div style="display: flex; flex-direction: row; align-items: center; background-color: #002044; color: rgb(249, 252, 229); font-size: 20px; font-weight: bold;">
  
  <!-- Current Time -->
  <div id="currentDateTime" style="padding: 10px 20px; white-space: nowrap;"></div>

  <!-- Scrolling News Ticker -->
  <marquee behavior="scroll" direction="left" scrollamount="5" style="flex: 1;">
    <div style="display: inline-flex; align-items: center; gap: 8px;">
     
      <span id="globalMessage" style="color: rgb(253, 253, 253); font-size: 16px;"></span>
    </div>
  </marquee>

</div>
 
<script>
function displayCurrentDateTime() {
const now = new Date();

// Formatting options
const options = { 
    weekday: 'long', 
    year: 'numeric', 
    month: 'long', 
    day: 'numeric', 
    hour: '2-digit', 
    minute: '2-digit', 
    second: '2-digit' 
};

// Formatting date and time
const formattedDateTime = now.toLocaleString('en-US', options);

// Displaying in the div
document.getElementById("currentDateTime").textContent = `Today: ${formattedDateTime}`;
}

// Call the function on page load to show the current date and time
displayCurrentDateTime();

// Update the date and time every second
setInterval(displayCurrentDateTime, 1000);
</script>
<!-- Current date and time will be displayed Stop -->

  </div>    <!-- footer div stop---- -->

</body>
</html>

  </div>  <!-- footer div stop -->




 <!-- ****************************** LOGIN DASHBOARD SCRIPT ******************************************************************** -->
<script>
const allOptions = [
   { value: "All", text: "All Classes" },
    { value: "Pre-Nursery", text: "PRE - NURSERY" },
  { value: "NURSERY - A", text: "NURSERY - A" },
  { value: "NURSERY - B", text: "NURSERY - B" },
  { value: "UKG - A", text: "UKG - A" },
  { value: "UKG - B", text: "UKG - B" },
  { value: "LKG - A", text: "LKG - A" },
  { value: "LKG - B", text: "LKG - B" },
  { value: "1st", text: "1st" },
  { value: "2nd", text: "2nd" },
  { value: "3rd", text: "3rd" },
  { value: "4th", text: "4th" },
  { value: "5th", text: "5th" },
  { value: "6th", text: "6th" }
];

// Google Sheets config
const apiKey = "AIzaSyBe-AlG9lpyXyC7KV-AavR6tbqOc75iYdM";
const sheetId = "1cXqnV7kKebvzk6-BAuuBNSmDnpJOyCqh7LRVB6sHiL4";
const range = "USER!A:G";

let users = {};
let currentUser = "";

// Fetch user data from Google Sheets
async function fetchUserData() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;
  try {
    const response = await fetch(url);
    const data = await response.json();
    const rows = data.values;
    users = {};

    for (let i = 1; i < rows.length; i++) {
      const [enabled, userId, password, status, displayName, permissions, vouchers] = rows[i];
      if (enabled === "3") {
        users[userId] = {
          password: password,
          displayName: displayName,
          status: status?.toLowerCase() || "unlocked",
          permissions: permissions?.split(',').map(p => parseInt(p.trim())),
          voucherIndexes: vouchers?.split(',').map(v => parseInt(v.trim())).filter(v => !isNaN(v)) || []
        };
      }
    }
  } catch (error) {
    console.error("Error fetching user data:", error);
    alert("Failed to load user data.");
  }
}

// Fetch and show global message from cell AI1
async function fetchGlobalMessage() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/USER!H4?key=${apiKey}`;
  try {
    const response = await fetch(url);
    const data = await response.json();

    const message = data?.values?.[0]?.[0] || "";

    const globalMessageDiv = document.getElementById('globalMessage');
    if (message.trim() !== "") {
      globalMessageDiv.innerText = message;
      globalMessageDiv.style.display = "block";
    } else {
      globalMessageDiv.style.display = "none";
    }
  } catch (error) {
    console.error("Error fetching global message:", error);
  }
}

// Initialize dashboard on login
async function initDashboard() {
  await fetchGlobalMessage();
  await fetchUserData();

  const userId = prompt("Enter User ID:");
  const password = prompt("Enter Password:");

  if (!users[userId] || users[userId].password !== password) {
    alert("Invalid User ID or Password!");
    disableAllButtons();
    document.getElementById('username').innerText = "Guest";
    document.getElementById("sectionGuest").classList.remove("hidden");
    return;
  }
// for status and licence date ***
const status = users[userId].status;

if (status === "locked") {
  alert("Your account is locked!");
  disableAllButtons();
  document.getElementById('username').innerText = "Locked User";
  return;
}

// Check if status is a date
const expiryDate = Date.parse(status);
if (!isNaN(expiryDate)) {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const diffTime = expiry - today;
  const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));

  if (diffDays < 0) {
    alert("Your Licence Expired, Please Contact Admin");
    disableAllButtons();
    document.getElementById('username').innerText = "Expired User";
    return;
  } else if (diffDays <= 5) {
    alert(`Your licence will expire in ${diffDays} day${diffDays === 1 ? '' : 's'}`);
  }
}
//***

  currentUser = userId;
  const user = users[userId];
  document.getElementById('username').innerText = user.displayName;



  updateDropdownFromIndexes(user.voucherIndexes);
  document.getElementById("CLASSUSER").addEventListener("change", syncledgerOption);

  document.querySelectorAll(".button-div button").forEach(btn => btn.disabled = false);
  showSection(1);
}

// Update voucher dropdown
function updateDropdownFromIndexes(indexes) {
  const CLASSUSER = document.getElementById("CLASSUSER");
  CLASSUSER.innerHTML = "";

  const defaultOption = document.createElement("option");
  defaultOption.value = "";
  defaultOption.textContent = "Select a Voucher";
  CLASSUSER.appendChild(defaultOption);

  indexes.forEach(index => {
    const optionData = allOptions[index];
    if (optionData) {
      const option = document.createElement("option");
      option.value = optionData.value;
      option.textContent = optionData.text;
      CLASSUSER.appendChild(option);
    }
  });

  syncledgerOption();
}

// Sync selected voucher to other dropdowns
function syncledgerOption() {
  const CLASSUSERSelect = document.getElementById("CLASSUSER");
  const selectedValue = CLASSUSERSelect.value;
  const selectedText = CLASSUSERSelect.options[CLASSUSERSelect.selectedIndex]?.text || "";

  const ledgerSelects = document.querySelectorAll(".dynamicDMPdp");

  ledgerSelects.forEach(ledgerSelect => {
    ledgerSelect.innerHTML = "";
    if (selectedValue && selectedText) {
      const newOption = document.createElement("option");
      newOption.value = selectedValue;
      newOption.textContent = selectedText;
      ledgerSelect.appendChild(newOption);
    }
  });
}

// Section permission check
function showSection(buttonNum) {
  document.querySelectorAll('.section').forEach(div => div.classList.add('hidden'));

  const permissions = users[currentUser]?.permissions || [];
  if (permissions.includes(buttonNum)) {
    const section = document.getElementById(`section${buttonNum}`);
    const extraSection = document.getElementById(`section${buttonNum}b`);
    if (section) section.classList.remove("hidden");
    if (extraSection) extraSection.classList.remove("hidden");
  } else {
    alert("You are not authorized for this function, Contact Admin");
    document.getElementById("section1")?.classList.remove("hidden");
    document.getElementById("section1b")?.classList.remove("hidden");
  }
}


function setUserCode() {
  if (typeof currentUser !== "undefined" && users[currentUser]) {
    const displayNameParts = users[currentUser].displayName.split("-");
    const userCode = displayNameParts.length > 1 ? displayNameParts[1].trim() : "";

    document.querySelectorAll('.usercode').forEach(input => {
      input.value = userCode;
    });
  }
}


// Disable buttons
function disableAllButtons() {
  document.querySelectorAll(".button-div button").forEach(btn => btn.disabled = true);
}

// Logout/reset
function logout() {
  location.reload();
}

window.onload = initDashboard;
</script>





</body>
</html>
 <!-- ****************************** LOGIN DASHBOARD SCRIPT ******************************************************************** -->
 



 
<!-- यह एक नोट है, script BSA02 Birthday event script start Heare -->

<table id="birthdayTable" style="display: none;">
    <tbody>
        <!-- Data from Google Sheets will be populated here -->
    </tbody>
</table>

<script>
    const apiBIRTHDAYKey = "AIzaSyCerUAdaqNQ7mxjgNBbAeiHDEKgN0Dzoao";
    const sheetBIRTHDAYId = "1BiADwSV64zXPz0UyVmYN7BlyW8DiCylgT3-bSrnIk38";
    const rangeBIRTHDAY = "RAGISTER!A:L";

    // Fetch data from Google Sheets
    async function birthSheet() {
        try {
            const response = await fetch(
                `https://sheets.googleapis.com/v4/spreadsheets/${sheetBIRTHDAYId}/values/${rangeBIRTHDAY}?key=${apiBIRTHDAYKey}`
            );
            const data = await response.json();

            if (data.values) {
                populatebirthTable(data.values);
                showTodayBirthdays();
            } else {
                console.error("No data found in the specified range.");
            }
        } catch (error) {
            console.error("Error fetching data from Google Sheets:", error);
        }
    }

    // Populate hidden table with Google Sheets data
    function populatebirthTable(values) {
        const tableBody = document.querySelector("#birthdayTable tbody");
        tableBody.innerHTML = ""; // Clear previous data

        values.forEach(row => {
            const tableRow = document.createElement("tr");
            row.forEach(cell => {
                const tableCell = document.createElement("td");
                tableCell.textContent = cell;
                tableRow.appendChild(tableCell);
            });
            tableBody.appendChild(tableRow);
        });
    }

    // Display today's birthdays
    function showTodayBirthdays() {
        const today = new Date();
        const todayDate = today.getDate(); // Get today's day (6 for "6-Feb")
        const todayMonth = today.toLocaleString("en", { month: "short" }); // Get today's month abbreviation (Feb)
        
        const rows = document.querySelectorAll("#birthdayTable tbody tr");
        const birthdayList = document.getElementById("birthdayList");
        birthdayList.innerHTML = ""; // Clear previous entries

        rows.forEach(row => {
            const dob = row.querySelectorAll("td")[3]?.textContent; // Ensure column 10 exists (DOB)
            if (dob) {
                // Parse DOB to match the format "6-Feb"
                const [dobDay, dobMonth] = dob.split("-").slice(0, 2); // Extract day and month
                const dobDayNumber = parseInt(dobDay); // Convert day to a number for comparison

                if (dobDayNumber === todayDate && dobMonth === todayMonth) {
                    const studentName = row.querySelectorAll("td")[2]?.textContent || "Unknown"; // Column 4: Name
                    const className = row.querySelectorAll("td")[1]?.textContent || "Unknown"; // Column 2: Class

                    const listItem = document.createElement("li");
                    listItem.textContent = `${studentName} (Class: ${className})`;
                    birthdayList.appendChild(listItem);
                }
            }
        });
    }

  document.addEventListener("DOMContentLoaded", function () {
    birthSheet();
});
</script>

  <!-- यह एक नोट है, script BSA02 Birthday event script Stop Heare -->


<!-- यह एक नोट है, logo code start -->

<style>
#floatingBrand {
  position: fixed;
  top: 8px;
  right: 400px;
  z-index: 9999;
  background: transparent;
  padding: 5px 10px;
  pointer-events: auto; /* Prevent clicks if needed */
}

/* Sticky Note Style */
#noteTooltip {
  display: none;
  position: absolute;
  top: 40px;
  right: 0;
  background-color: #cceaff;
  border: 1px solid #013556;
  padding: 10px;
  width: 200px;
  font-family: Arial, sans-serif;
  font-size: 90%;
  box-shadow: 2px 2px 10px rgba(0,0,0,0.2);
  z-index: 10000;
  border-radius: 5px;
}
</style>
</style>

<div id="floatingBrand">
  <span style="color:rgb(246, 156, 156);font-size:130%;font-family:Magneto;">eS |</span> 
  <span style="color:#a0d0f0;font-size:130%;font-family:Magneto;">MTally</span>
   <div id="noteTooltip">Design By: eS|MTally <br/> Admin: Mukhtiyar Ahamad <br/> Contect: +91-9756735792</div>
</div>


<script>
const brand = document.getElementById('floatingBrand');
const tooltip = document.getElementById('noteTooltip');

// Show on hover
brand.addEventListener('mouseenter', () => {
  tooltip.style.display = 'block';
});

// Hide when mouse leaves
brand.addEventListener('mouseleave', () => {
  tooltip.style.display = 'none';
});
</script>
<!-- यह एक नोट है, logo code stop -->







<!-- यह एक नोट है, events Event script Start Heare -->

<!-- यह एक नोट है, events Event script Start Heare -->



<script>
    const apiEVENTKey = "AIzaSyCerUAdaqNQ7mxjgNBbAeiHDEKgN0Dzoao";
    const sheetEVENTId = "1BiADwSV64zXPz0UyVmYN7BlyW8DiCylgT3-bSrnIk38";
    const rangeEVENT = 'EVENT!A:J';

    // Fetch data from Google Sheets and process
    async function eventSheet() {
        try {
            const response = await fetch(
                `https://sheets.googleapis.com/v4/spreadsheets/${sheetEVENTId}/values/${rangeEVENT}?key=${apiEVENTKey}`
            );
            const data = await response.json();

            if (data.values) {
                showTodayevents(data.values);
            } else {
                console.error("No data found in the specified range.");
            }
        } catch (error) {
            console.error("Error fetching data from Google Sheets:", error);
        }
    }

    // Display today's events in #eventsList div
    function showTodayevents(values) {
        const today = new Date();
        const todayDate = today.getDate();
        const todayMonth = today.toLocaleString("en", { month: "short" });

        let htmlContent = "<strong>Today's Events:</strong><br/><ul>";

        values.forEach(row => {
            const dob = row[2]; // Assuming DOB is in 3rd column (index 2)
            if (dob) {
                const [dobDay, dobMonth] = dob.split("-").slice(0, 2);
                const dobDayNumber = parseInt(dobDay);

                if (dobDayNumber === todayDate && dobMonth === todayMonth) {
                    const name = row[1] || "No Event Today"; // Assuming Name is in 2nd column (index 1)
                    const cls = row[3] || ""; // Assuming Class is in 4th column (index 3)
                    htmlContent += `<li>${name} ${cls}</li>`;
                }
            }
        });

        htmlContent += "</ul>";
        document.getElementById("eventsList").innerHTML = htmlContent;
    }

    // Auto-run function immediately
    (async () => {
        await eventSheet();
    })();
</script>

<!-- यह एक नोट है,  Event script stop Here -->







<!-- ****************************************** voucher forms summry table ************************************************************ -->
<script>
const apiSRldgrKey = "AIzaSyCerUAdaqNQ7mxjgNBbAeiHDEKgN0Dzoao";
const sheetSRldgrId = "1BiADwSV64zXPz0UyVmYN7BlyW8DiCylgT3-bSrnIk38";
const rangeSRldgr = 'INDEX!A:AS';
const rangeID = 'RAGISTER!A:Q';

let allSRldgrRows = [];
let allRegisterRows = [];

async function fetchBSASRtable() {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetSRldgrId}/values/${rangeSRldgr}?key=${apiSRldgrKey}`;
    try {
        const response = await fetch(url);
        const data = await response.json();
        const rows = data.values || [];
        allSRldgrRows = rows.slice(1);

        await fetchCLASSdata(); // Fetch register data after voucher
        studentCLASStable();
    } catch (error) {
        console.error("Error fetching voucher data:", error);
        document.getElementById('tableBodySRldgr').innerHTML = "<tr><td colspan='11'>Error loading data.</td></tr>";
    }
}

async function fetchCLASSdata() {
    const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetSRldgrId}/values/${rangeID}?key=${apiSRldgrKey}`;
    try {
        const response = await fetch(url);
        const data = await response.json();
        allRegisterRows = data.values.slice(1) || [];
    } catch (error) {
        console.error("Error fetching register data:", error);
    }
}
function studentCLASStable() {
    const selectedVoucher = document.getElementById("CLASSUSER").value.trim().toUpperCase();
    const selectedSession = document.getElementById("SESSIONYEAR")?.value.trim().toUpperCase();

    const wrapper = document.getElementById("classWrapper");
    const message = document.getElementById("classOPTIONMessage");

    if (!selectedVoucher || !selectedSession) {
        wrapper.style.display = "none";
        message.style.display = "block";
        return;
    }

    wrapper.style.display = "block";
    message.style.display = "none";

    const tableBodySRldgr = document.getElementById("tableBodySRldgr");
    const tableHead = document.getElementById("tableHeadSRldgr");

    const studentVouchers = [
       "PRE-NURSERY", "NURSERY - A", "NURSERY - B", "LKG - A", "LKG - B",
        "UKG - A", "UKG - B", "1ST", "2ND", "3RD", "4TH", "5TH", "6TH"
    ];

    let headerHTML = "";
    let visibleIndexes = [];

    if (selectedVoucher === "ALL" || studentVouchers.includes(selectedVoucher)) {
        headerHTML = `
            <tr>
                <th>ANo.</th><th>Class</th><th>Student Name</th><th>Father Name</th>
                <th>Mother Name</th><th>Date Of Birth</th><th>Roll No.</th><th>PEN No</th><th>Attendance</th>
            </tr>`;
        visibleIndexes = [0,1,2,3,4,5,6,7,36];
    } else if (selectedVoucher === "PRE-NURSERY") {
        headerHTML = `
            <tr style="background-color: green; color: white;">
                <th>ANo.</th><th>Class</th><th>Student Name</th><th>Father Name</th>
                <th>Mother Name</th><th>Date Of Birth</th><th>Roll No.</th>
            </tr>`;
        visibleIndexes = [0, 1, 2, 3,4,5,6];
    } else {
        visibleIndexes = [...Array(12).keys()];
    }

    tableHead.innerHTML = headerHTML;

    const searchTerm = document.getElementById("serchbarSRldgr")?.value.toLowerCase() || "";

    // ✅ FILTER & SORT BEFORE USE
    const filteredRows = allSRldgrRows.filter(row => {
        const rowVoucher = row[1]?.trim().toUpperCase();
        const rowSession = row[39]?.trim().toUpperCase();

        const matchesVoucher = selectedVoucher === "ALL"
            ? studentVouchers.includes(rowVoucher)
            : rowVoucher === selectedVoucher;

        const matchesSession = !selectedSession || rowSession === selectedSession;

        const matchesSearch = searchTerm === "" || row.some(cell =>
            (cell || "").toLowerCase().includes(searchTerm)
        );

        return matchesVoucher && matchesSession && matchesSearch;
    });

    filteredRows.sort((a, b) => (parseInt(b[0]) || 0) - (parseInt(a[0]) || 0));

    // ✅  stundent no start
    tableBodySRldgr.innerHTML = filteredRows.length
        ? filteredRows.map(row => {
            return `<tr>${visibleIndexes.map((i, idx) => {
                const cellData = row[i] || "";
                if (i === 0) {
                    return `<td style="color:blue;cursor:pointer;" onclick="showRegisterDetails('${cellData}')">${cellData}</td>`;
                }
                return `<td>${cellData}</td>`;
            }).join("")}</tr>`;
        }).join("")
        : `<tr><td colspan="${visibleIndexes.length}" style="text-align:center;">No matching data found.</td></tr>`;

    // ✅ Total Count Show
    const rowCountDisplay = document.getElementById("rowCountDisplay");
    rowCountDisplay.innerHTML = `👨‍🎓 Total Student in This Class: <span style="color: Black;">${filteredRows.length}</span>`;
    // stundent no stop
}

function printSTUDENTtable() {
    const wrapper = document.getElementById("classWrapper");
    const rowCount = document.getElementById("rowCountDisplay");

    const selectedVoucher = document.getElementById("CLASSUSER")?.value || "";
    const selectedSession = document.getElementById("SESSIONYEAR")?.value || "";

    if (!wrapper || wrapper.style.display === "none") {
        alert("No table data available to print!");
        return;
    }

    const printWindow = window.open("", "", "height=700,width=1000");

    printWindow.document.write(`<html><head><title>Print Table</title>`);
    printWindow.document.write(`
        <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            table { border-collapse: collapse; width: 100%; margin-top: 10px; }
            th, td { border: 1px solid #444; padding: 8px; text-align: left; }
            th { background-color: #004d80; color: white; }
            .info-bar {
                display: flex;
                justify-content: space-between;
                align-items: center;
                font-size: 16px;
                font-weight: bold;
                margin-bottom: 10px;
                gap: 10px;
            }
        </style>
    `);
    printWindow.document.write(`</head><body>`);

    // ✅ Info bar with voucher, session and row count in one row
    printWindow.document.write(`
        <div class="info-bar">
            <div>📚 Class: ${selectedVoucher}</div>
            <div>📅 Session: ${selectedSession}</div>
            <div>${rowCount?.innerHTML || ""}</div>
        </div>
    `);

    // ✅ Add table HTML
    printWindow.document.write(wrapper.innerHTML);

    printWindow.document.write(`</body></html>`);
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
    printWindow.close();
}



//
function searchSRldgrTable() {
    studentCLASStable();
}
//
function showRegisterDetails(ano) {
    const resultDiv = document.getElementById("registerDetails");
    const matched = allRegisterRows.find(row => (row[0] || "").trim() === ano);

    if (matched) {
        const detailHtml = `
            <h3>Student Details for A No: ${ano}</h3>
            <strong style="color: #b44403; font-weight: bold;">Student Name: ${matched[2] || ""} </strong> 
            <ul>
                <li><strong>Class:</strong> ${matched[1] || ""}</li>
                <li><strong>Date Of Birth:</strong> ${matched[3] || ""}</li>
                <li><strong>Father Name:</strong> ${matched[4] || ""}</li>
                <li><strong>Mother Name:</strong> ${matched[5] || ""}</li>
                <li><strong>Adhar No.:</strong> ${matched[6] || ""}</li>
                <li><strong>Mobile:</strong> ${matched[7] || ""}</li>
                <li><strong>Apar No.:</strong> ${matched[8] || ""}</li>
                <li><strong>Address:</strong> ${matched[9] || ""}</li>
                <li><strong>PEN No:</strong> ${matched[10] || ""}</li>
                <li><strong>Religion:</strong> ${matched[11] || ""} / ${matched[12] || ""}</li>
              
                <li>
  <strong>Status:</strong>
  ${matched[14] === "R" ? "<span style='color: green;'>Regular</span>" 
  : matched[14] === "T" ? "<span style='color: red;'>Transfer</span>" 
  : (matched[14] || "")}
</li>

         
            </ul>
        `;
        resultDiv.innerHTML = detailHtml;
    } else {
        resultDiv.innerHTML = `<p style="color:red;">No student found for A No: ${ano}</p>`;
    }
}

document.addEventListener("DOMContentLoaded", () => {
    document.getElementById("CLASSUSER").addEventListener("change", studentCLASStable);
    document.getElementById("SESSIONYEAR").addEventListener("change", studentCLASStable);
    fetchBSASRtable();
});
</script>

<!-- ****************************************** voucher forms summry table ************************************************************ -->





<!-- markseet Certificate script and code start-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSA Marksheet</title>
    <style>
        
                body { font-family: Arial, sans-serif; margin: 20px;}
                
           
        .MarkBSAEsheet {
            margin-top: 30px;
            padding: 15px;
            border: 1px solid #fcf8f8;
            background-color: #f9f9f9;
        }
        .MarkBSAEsheet h2 {
            text-align: center;
        }

        
       .formBSAcontainer {
    margin-bottom: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 8px;
    max-width: 500px;
    background-color: #f9f9f9;
    display: flex;
    flex-direction: column;
    gap: 10px;
    font-family: Arial, sans-serif;
}

.formBSAcontainer label {
    font-weight: bold;
    margin-bottom: 5px;
}

.formBSAcontainer select {
    padding: 8px;
    font-size: 14px;
    border: 1px solid #aaa;
    border-radius: 4px;
}

.formBSAcontainer .error {
    color: red;
    font-size: 13px;
}


        .error {
            color: red;
            font-size: 14px;
        }
      
    </style>
</head>
<body>

   

    <script>
   let sheetBSAdata = []; // Store fetched data

async function marksheetBSAload() {
    const apiKey = "AIzaSyCerUAdaqNQ7mxjgNBbAeiHDEKgN0Dzoao";
            const sheetId = "1BiADwSV64zXPz0UyVmYN7BlyW8DiCylgT3-bSrnIk38";
            const range = 'INDEX!A:AS';

    try {
        const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`
        );
        const data = await response.json();

        if (data.values) {
            sheetBSAdata = data.values;
            console.log("Data Loaded Successfully:", sheetBSAdata);
        } else {
            console.error("No data found in the specified range.");
        }
    } catch (error) {
        console.error("Error fetching data from Google Sheets:", error);
    }
}

function updateBSADropdown() {
    const selectedClass = document.getElementById("clasBSAswise").value.trim();
    const selectedSession = document.getElementById("BSAsession").value.trim();
    const admissionDropdown = document.getElementById("aBSAEno");

    //
    const studentCountDiv = document.getElementById("totalBSAStudents");
    const topBSAStudentDiv = document.getElementById("topBSAStudent");

    let studentCount = 0;
    let topThree = [];


    //

    admissionDropdown.innerHTML = '<option value="">Select Admission No</option>';

    sheetBSAdata.forEach(row => {
        if (row[1]?.trim() === selectedClass && row[39]?.trim() === selectedSession) {
            let option = document.createElement("option");
            option.value = row[0];
            option.textContent = row[0];
            admissionDropdown.appendChild(option);


            //
            studentCount++;

         //   let totalMarks = 0;
           // for (let i = 8; i <= 37; i++) {
             //   totalMarks += isNaN(parseInt(row[i])) ? 0 : parseInt(row[i]);

             let totalMarks = 0;
const indexes = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 41, 42, 43, 44];

for (let i of indexes) {
    totalMarks += isNaN(parseInt(row[i])) ? 0 : parseInt(row[i]);

            }

            topThree.push({
                name: row[2],
                admissionNo: row[0],
                totalMarks: totalMarks
            });

            //
        }
    });

    //

    topThree.sort((a, b) => b.totalMarks - a.totalMarks);
    
    let topResults = topThree.length > 0 ? `  <span style="color:#1F7A55;font-size:90%;font-family:Arial;">1st: ${topThree[0].name} (A.No: ${topThree[0].admissionNo}) (Total Marks: ${topThree[0].totalMarks}) </span> | ` : ""; 
    if (topThree.length > 1) {
        topResults += `    <br/> <span style="color:#193CB8;font-size:90%;font-family:Arial;">  2nd: ${topThree[1].name} (A.No: ${topThree[1].admissionNo}) (Total Marks: ${topThree[1].totalMarks}) </span>  | `;
    }
    if (topThree.length > 2) {
        topResults += ` <br/><span style="color:#9F0712;font-size:90%;font-family:Arial;">  3rd: ${topThree[2].name} (A.No: ${topThree[2].admissionNo}) (Total Marks: ${topThree[2].totalMarks}) </span> `;
    }

    studentCountDiv.innerHTML = selectedClass ? `Total students in ${selectedClass}: <strong>${studentCount}</strong>` : "";
    topBSAStudentDiv.innerHTML = topResults;

    //
}



function MarkBSAEsheet() {
    const admissionNo = document.getElementById("aBSAEno").value.trim();
    const selectedClass = document.getElementById("clasBSAswise").value.trim();
    const selectedSession = document.getElementById("BSAsession").value.trim();
    const marksheetContent = document.getElementById("marksheetE-BSAview");
    const errorMessage = document.getElementById("error-message");
    const printBSAButton = document.getElementById("printBSAButton");

    marksheetContent.innerHTML = "";
    errorMessage.textContent = "";
    printBSAButton.style.display = "none";

    if (!admissionNo || !selectedClass || !selectedSession) {
        errorMessage.textContent = "Please select Session, Class, and Admission No.";
        return;
    }

    let studentFound = false;
    const getValue = (val) => (val === undefined || val === null || val === "" ? "" : val);
    const getNumericValue = (val) => isNaN(parseInt(val)) ? 0 : parseInt(val);

    let maxMarks = 600;
    if (["3rd", "4th", "5th"].includes(selectedClass)) {
        maxMarks = 1400;
    } else if (["1st", "2nd"].includes(selectedClass)) {
        maxMarks = 1200;
    } else if (["UKG - B", "UKG - A", "UKG"].includes(selectedClass)) {
        maxMarks = 800;
    }

    const getSafeSum = (...values) => {
        let sum = 0;
        let hasValidValue = false;
        values.forEach(val => {
            const num = isNaN(parseInt(val)) ? 0 : parseInt(val);
            if (num !== 0) hasValidValue = true;
            sum += num;
        });
        return hasValidValue ? sum : "";
    };

     //  class position code start
    let topThree = [];
    for (let i = 1; i < sheetBSAdata.length; i++) {
        let row = sheetBSAdata[i];
        if (row[1] === selectedClass && row[39] === selectedSession) {
            let totalMarks = 0;
            let subjects = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 41, 42, 43, 44];

            subjects.forEach(index => {
                totalMarks += getNumericValue(row[index]);
            });

            const percentage = (totalMarks / maxMarks) * 100;
            topThree.push({
                name: row[2],
                admissionNo: row[0],
                totalMarks: totalMarks,
                percentage: percentage.toFixed(2)
            });
        }
    }

    // Step 2: Sort the students by total marks
    topThree.sort((a, b) => b.totalMarks - a.totalMarks);

    // Step 3: Find the position of the selected student (admissionNo) in the topThree array
    let position = "";
    topThree.forEach((student, index) => {
        if (student.admissionNo === admissionNo) {
            position = index === 0 ? "1st" : (index === 1 ? "2nd" : (index === 2 ? "3rd" : ""));
        }
    });

//  class position code stop

    // Step 4: Check if student exists and generate their marksheet
    for (let i = 1; i < sheetBSAdata.length; i++) {
        let row = sheetBSAdata[i];
        if (row[0] === admissionNo && row[1] === selectedClass && row[39] === selectedSession) {
            studentFound = true;
            let totalMarks = 0;
            let subjects = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 41, 42, 43, 44];

            subjects.forEach(index => {
                totalMarks += getNumericValue(row[index]);
            });

            //
const issueDateMap = {
    "2024-25": "29-Mar-2025",
    "2023-24": "27-Mar-2024",
    "2022-23": "20-Mar-2023"
};

const issueDate = issueDateMap[selectedSession] || "N/A"; // Default if no match

//

        //
        const newsessionBegin = {
    "2024-25": "04-Apr-25 at 7:35 AM",
    "2023-24": "04-Apr-24 at 7:45 AM",
    "2022-23": "01-May-2023"
};

const sessionBegin = newsessionBegin[selectedSession] || "N/A"; // Default if no match

//


            const percentage = (totalMarks / maxMarks) * 100;
            const roundedPercentage = percentage.toFixed(2);

            const grade =
                percentage >= 90 ? "A++" :
                percentage >= 80 ? "A+" :
                percentage >= 70 ? "A" :
                percentage >= 60 ? "B++" :
                percentage >= 50 ? "B+" :
                percentage >= 40 ? "B" :
                percentage >= 33 ? "C" :
                "Fail";




// Check if it's for UKG
if (["UKG", "UKG - A", "UKG - B"].includes(selectedClass)) {
                    marksheetContent.innerHTML = `
                        

                        
<table class="marksheet-table">
<table style="width:100%; border: none;"> 

    <tr style="border: none;">  
<td style="background-color:white;text-align: center; color:white;border: none;">
<img style="width:900px; height:160px; align:center;" src="BSA.JPG" />
</td>
</tr>

</table>

<table style="width:100%;">

<td style="background-color: #1c2833 ;text-align: center; color: white ;"><span style="color: white ;font-size:150%; font-weight: bold;"> REPORT CARD:  ${row[39]} </span></td>
</table>



<table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: </span> </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${getValue(row[0])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ROLL NO. : </span></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${row[6]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
<tr style="border: none;"> 
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>

<tr style="border: none;">  
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"><span style="color: BLACK ;font-size:100%; font-weight: bold;"> Duplicate</span></td>
</td>

</tr>
</table>

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center;font-weight: bold; color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>


<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">HINDI</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">ENGLISH</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[12]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[18]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[24]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[30]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[24], row[30])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18], row[24], row[30])} </span></td>
</tr>

<table style="width:100%"> 
<td style="background-color: black ;text-align: right ; color: white ;font-weight: bold;border: none;">Mark Percentage: ${roundedPercentage} %</td>
<td style="background-color: black ;text-align: center; color: white ;font-weight: bold;border: none;">Total Marks: ${totalMarks}/800 </td>
</td>
</table>

<table style="width:100%: "> 
<td style="background-color: #273746 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}
<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: green ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Promotion For Granted to Next Class: </span>Granted </td>
</tr>
</table>

<span style="color: black ;font-size:95%;">New Session begins on: ${sessionBegin}  </span>

<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Class Teacher Sign </span></td>

<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Principal Sign </span></td>
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Parents/Guardian Sign.</span> </td>
</tr>
</table>
<span style="color: BLACK ;font-size:65%;">** Marks Grade (%): A++ (90-100), A+ (80-90), A (70-80), B++ (60-70), B+ (50-60), B (40-50), C (33-40) </span> <br/>

<span style="color: BLUE ;font-size:95%;">Issue Date:${issueDate} </span>
</table>

                    `;


                } 

                else if (["Pre-Nursery"].includes(selectedClass)) {
                marksheetContent.innerHTML = `
                                        
<table class="marksheet-table">
<table style="width:100%; border: none;"> 

       <tr style="border: none;">  
<td style="background-color:white;text-align: center; color:white;border: none;">
<img style="width:900px; height:160px; align:center;" src="BSA.JPG" />
</td>
</tr>

</table>

<table style="width:100%;">
<td style="background-color: #1c2833 ;text-align: center; color: white ;"><span style="color: white ;font-size:150%; font-weight: bold;"> REPORT CARD:  ${row[39]} </span></td>
</table>



<table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: </span> </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${getValue(row[0])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ROLL NO. : </span></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${row[6]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
<tr style="border: none;"> 
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>

<tr style="border: none;">  
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"><span style="color: BLACK ;font-size:90%; font-weight: bold;"></span></td>
</td>

</tr>
</table>

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center;font-weight: bold; color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; ">
<tr style="border: none;">
<td style="background-color: #d5d8dc ;text-align: center ; color: WHITE ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: WHITE ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
</tr>

<tr style="border: none;"> 
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">HINDI</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</tr>

<tr style="border: none;">
<td style="background-color: white ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">ENGLISH</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[9])}</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
</tr>

<tr style="border: none;">
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">MATH</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[10])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</tr>

<tr style="border: none;">
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">DRAWING</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[11])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</tr>


<table style="width:100%: "> 
<td style="background-color: #273746 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[12])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Oral</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[13])}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[15])}</td>
</tr>

</table>
<BR/>
<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${getValue(row[17])}
<table style="width:100%"> 
<tr> 
    <td style="background-color: whit ;text-align: left ; color: balck ;"> Class Position: <span style="color: green ;font-size:95%; font-weight: bold;"> ${getValue(row[40])} </span>  </span>   </span></td>
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Promotion For Granted to Next Class: </span>Granted </td>
</tr>
</table>
<BR/>
<span style="color: black ;font-size:95%;">New Session begins on: ${sessionBegin}  </span>


<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Class Teacher Sign </span></td>

<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Principal Sign </span></td>
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Parents/Guardian Sign.</span> </td>
</tr>
</table>
<span style="color: BLACK ;font-size:65%;">** Marks Grade (%): A++ (90-100), A+ (80-90), A (70-80), B++ (60-70), B+ (50-60), B (40-50), C (33-40) </span> <br/>

<span style="color: BLUE ;font-size:95%;">Issue Date:${issueDate} </span>
</table>

                `;
            }
                
                else if (["NURSERY - A", "NURSERY - B", "LKG - A", "LKG - B"].includes(selectedClass)) {
                marksheetContent.innerHTML = `
                                        
<table class="marksheet-table">
<table style="width:100%; border: none;"> 
    
       <tr style="border: none;">  
<td style="background-color:white;text-align: center; color:white;border: none;">
<img style="width:900px; height:160px; align:center;" src="BSA.JPG" />
</td>
</tr>

</table>

<table style="width:100%;">
<td style="background-color: #1c2833 ;text-align: center; color: white ;"><span style="color: white ;font-size:150%; font-weight: bold;"> REPORT CARD:  ${row[39]} </span></td>
</table>



<table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: </span> </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${getValue(row[0])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ROLL NO. : </span></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${row[6]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
<tr style="border: none;"> 
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>

<tr style="border: none;">  
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"><span style="color: BLACK ;font-size:100%; font-weight: bold;"> Duplicate</span></td>
</td>

</tr>
</table>

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center; font-weight: bold;color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>


<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">HINDI</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">ENGLISH</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>

<table style="width:100%"> 
<td style="background-color: black ;text-align: right ; color: white ;font-weight: bold;border: none;">Mark Percentage: ${roundedPercentage} %</td>
<td style="background-color: black ;text-align: center; color: white ;font-weight: bold;border: none;">Total Marks: ${totalMarks}/600 </td>
</td>
</table>

<table style="width:100%: "> 
<td style="background-color: #273746 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}
<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: green ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Promotion For Granted to Next Class: </span>Granted </td>
</tr>
</table>

<span style="color: black ;font-size:95%;">New Session begins on: ${sessionBegin}  </span>


<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Class Teacher Sign </span></td>

<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Principal Sign </span></td>
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Parents/Guardian Sign.</span> </td>
</tr>
</table>

<span style="color: BLACK ;font-size:65%;">** Marks Grade (%): A++ (90-100), A+ (80-90), A (70-80), B++ (60-70), B+ (50-60), B (40-50), C (33-40) </span> <br/>

<span style="color: BLUE ;font-size:95%;">Issue Date:${issueDate} </span>
</table>

                `;
            }

            else if (["1st", "2nd"].includes(selectedClass)) {
            
                marksheetContent.innerHTML = `
                   
                                            
<table class="marksheet-table">
<table style="width:100%; border: none;"> 
    
       <tr style="border: none;">  
<td style="background-color:white;text-align: center; color:white;border: none;">
<img style="width:900px; height:160px; align:center;" src="BSA.JPG" />
</td>
</tr>

</table>

<table style="width:100%;">
<td style="background-color: #1c2833 ;text-align: center; color: white ;"><span style="color: white ;font-size:150%; font-weight: bold;"> REPORT CARD:  ${row[39]}</span></td>
</table>






<table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: </span> </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${getValue(row[0])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ROLL NO. : </span></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${row[6]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
<tr style="border: none;"> 
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>

<tr style="border: none;">  
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> Duplicate </span></td>
</td>

</tr>
</table>

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center; font-weight: bold; color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>

<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>


<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Hindi Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">English Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">E.V.S</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[11]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[17]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[23]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[29]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[23], row[29])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17], row[23], row[29])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[12]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[18]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[24]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[30]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[24], row[30])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18], row[24], row[30])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Computer</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[13]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[19]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[25]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[31]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[25], row[31])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19], row[25], row[31])}</span></td>
</tr>



<table style="width:100%"> 
<td style="background-color: black ;text-align: right ; color: white ;font-weight: bold;border: none;">Mark Percentage: ${roundedPercentage} %</td>
<td style="background-color: black ;text-align: center; color: white ;font-weight: bold;border: none;">Total Marks: ${totalMarks}/1200 </td>
</td>
</table>

<table style="width:100%: "> 
<td style="background-color: #273746 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}
<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: green ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Promotion For Granted to Next Class: </span>Granted </td>
</tr>
</table>

<span style="color: black ;font-size:95%;">New Session begins on: ${sessionBegin}  </span>


<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Class Teacher Sign </span></td>

<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Principal Sign </span></td>
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Parents/Guardian Sign.</span> </td>
</tr>
</table>

<span style="color: BLACK ;font-size:65%;">** Marks Grade (%): A++ (90-100), A+ (80-90), A (70-80), B++ (60-70), B+ (50-60), B (40-50), C (33-40) </span> <br/>

<span style="color: BLUE ;font-size:95%;">Issue Date:${issueDate} </span>
</table>

                `;
            }

            else {
                //  3rd, and 4th, 5th classes
                marksheetContent.innerHTML = `
                   
                                            
<table class="marksheet-table">
<table style="width:100%; border: none;"> 
    
       <tr style="border: none;">  
<td style="background-color:white;text-align: center; color:white;border: none;">
<img style="width:900px; height:160px; align:center;" src="BSA.JPG" />
</td>
</tr>

</table>

<table style="width:100%;">
<td style="background-color: #1c2833 ;text-align: center; color: white ;"><span style="color: white ;font-size:150%; font-weight: bold;"> REPORT CARD:  ${row[39]}</span></td>
</table>






<table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: </span> </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${getValue(row[0])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ROLL NO. : </span></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">${row[6]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>
  
<tr style="border: none;"> 
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</td>

</tr>

<tr style="border: none;">  
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> Duplicate </span></td>
</td>

</tr>
</table>

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center; font-weight: bold;color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>

<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>


<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Hindi Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">English Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">E.V.S</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[11]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[17]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[23]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[29]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[23], row[29])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17], row[23], row[29])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[12]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[18]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[24]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[30]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[24], row[30])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18], row[24], row[30])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Computer</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[13]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[19]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[25]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[31]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[25], row[31])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19], row[25], row[31])}</span></td>
</tr>


<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Sanskrit</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[41])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[42])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[41], row[42])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[43])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[44])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[43], row[44])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[41], row[42], row[43], row[44])} </span></td>
</tr>

<table style="width:100%"> 
<td style="background-color: black ;text-align: right ; color: white ;font-weight: bold;border: none;">Mark Percentage: ${roundedPercentage} %</td>
<td style="background-color: black ;text-align: center; color: white ;font-weight: bold;border: none;">Total Marks: ${totalMarks}/1400 </td>
</td>
</table>

<table style="width:100%: "> 
<td style="background-color: #273746 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}
<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: green ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>
<td style="background-color: whit ;text-align: left ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">Promotion For Granted to Next Class: </span>Granted </td>
</tr>
</table>

<span style="color: black ;font-size:95%;">New Session begins on: ${sessionBegin}  </span>


<table style="width:100%"> 
<tr> 
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Class Teacher Sign </span></td>

<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Principal Sign </span></td>
<td style="background-color: whit ;text-align: center ; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"><br/><br/>________________________________<br/>Parents/Guardian Sign.</span> </td>
</tr>
</table>

<span style="color: BLACK ;font-size:65%;">** Marks Grade (%): A++ (90-100), A+ (80-90), A (70-80), B++ (60-70), B+ (50-60), B (40-50), C (33-40) </span> <br/>

<span style="color: BLUE ;font-size:95%;">Issue Date:${issueDate} </span>
</table>
                `;
            }

            printBSAButton.style.display = "block";
            break;
        }
    }

    if (!studentFound) {
        errorMessage.textContent = "No student found with the given Admission No.";
    }
}


    
          
    
        function sheetBSAdataPrint() {
            const printWindow = window.open("", "_blank");
            const styles = `
                <style>
                body { font-family: Arial, sans-serif; margin: 20px;}
                
                 table {
                width: 100%;
                border-collapse: collapse;
                box-shadow: 0 0 15px rgba(0,0,0,0.1);
                background-color: #fff;
                margin-top: 20px;
                border-radius: 10px;
                overflow: hidden;
                font-size: 15px;
            }
    
            th, td {
                padding: 12px;
                border: 1px solid #ddd;
                text-align: center;
            }
    
            th {
                background: #0077b6;
                color: white;
                font-weight: bold;
                font-size: 15px;
            }

            </style>
            `;
    
            printWindow.document.write("<html><head><title>Student Marksheet</title></head><body>");
            printWindow.document.write(styles);
            printWindow.document.write(document.getElementById("marksheetE-BSAview").outerHTML);
            printWindow.document.close();
            printWindow.print();
        }
    
  //      window.onload = marksheetBSAload;

        document.addEventListener("DOMContentLoaded", () => {
 
    marksheetBSAload();
});
    </script>
    
    
</body>
</html>

<!-- markseet Certificate script and code stop-->









<!-- Transfer Certificate script and code start-->


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Transfer Certificate</title>
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background: #f9f9f9;
      padding: 40px;
    }

    .certificate {
      max-width: 900px;
      margin: auto;
      padding: 40px;
      background: #fff;
      border: 4px double #000;
      box-shadow: 0 0 15px rgba(0,0,0,0.1);
    }

    .headerTC {
      text-align: center;
      border-bottom: 2px solid #000;
      padding-bottom: 10px;
      margin-bottom: 30px;
    }

    .headerTC h1 {
      margin: 0;
      font-size: 28px;
      letter-spacing: 1px;
    }

    .headerTC h2 {
      margin: 5px 0;
      font-size: 18px;
    }

    .headerTC p {
      margin: 4px;
      font-size: 15px;
    }

      .titleTC {
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      margin: 30px 0 20px;
      text-decoration: underline;
    }

    .info-table {
      border: 1px solid #000;
      border-collapse: collapse;
      width: 100%;
      font-size: 16px;
    }

    .info-table td, .info-table th {
      border: 1px solid #000;
      padding: 6px 10px;
      vertical-align: top;
    }

    .signature-section {
      margin-top: 50px;
      display: flex;
      justify-content: space-between;
    }

    .signature {
      width: 45%;
      text-align: center;
      font-size: 15px;
    }

    .signature-line {
      margin-top: 60px;
      border-top: 1px solid #000;
      width: 80%;
      margin-left: auto;
      margin-right: auto;
    }

   
  </style>
</head>
<body>

<script>
const apiTCKey = "AIzaSyCerUAdaqNQ7mxjgNBbAeiHDEKgN0Dzoao";
const sheetTCId = "1BiADwSV64zXPz0UyVmYN7BlyW8DiCylgT3-bSrnIk38";
const rangeTC = "RAGISTER!A:AN";
let allData = [];

async function fetchTCdata() {
  const url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetTCId}/values/${rangeTC}?key=${apiTCKey}`;
  const res = await fetch(url);
  const data = await res.json();
  const rows = data.values;

  if (!rows || rows.length < 2) {
    console.error("No data found.");
    return;
  }

  // Filter rows where column O (index 14) === 'T'
  allData = rows.slice(1).filter(row => row[14] && row[14].trim().toUpperCase() === "T");

  const dropdown = document.getElementById("studentTCDropdown");
  dropdown.innerHTML = '<option value="">-- Select Admission No. --</option>';

  allData.forEach(row => {
    const option = document.createElement("option");
    option.value = row[0]; // Admission No. from Column A
    option.textContent = row[0];
    dropdown.appendChild(option);
  });

  getHighestTCNumber(); // Add this line fot last tc no
}

function generateTCTable(row) {

  //*** 
    const today = new Date();
  const issueDate = new Date(row[21]);
  const diffTime = issueDate.getTime() - today.getTime();
  const diffDays = Math.floor(diffTime / (1000 * 3600 * 24));

  let status = "";
  if (Math.abs(diffDays) <= 15) {
    status = "Original";
  } else {
    status = "Duplicate";
  }
//***
  const tableHTML = `

   <div style="margin-bottom: 10px; font-weight: bold; color: #003636;">
 ${status}
</div>


  <strong style="color: #003636; font-weight: bold;">Admission No.: ${row[0] || ""} </strong> &nbsp;&nbsp;&nbsp;
   <strong style="color: #003636; font-weight: bold;">Certificate No.: ${row[15] || ""} </strong>  &nbsp;&nbsp;&nbsp;
   <strong style="color: #003636; font-weight: bold;">PEN No.: ${row[10] || ""}</strong> 
    <table class="info-table">
      <tr><td>1</td><td>Name of Student</td><td><strong>${row[2] || ""}</strong></td></tr>
      <tr><td>2</td><td>Father's/Guardian's Name</td><td><strong>${row[4] || ""}</strong></td></tr>
      <tr><td>3</td><td>Mother's Name</td><td><strong>${row[5] || ""}</strong></td></tr>
      <tr><td>4</td><td>Nationality</td><td><strong>Indian</strong></td></tr>
      <tr><td>5</td><td>Category (GEN/SC/ST/OBC)</td><td><strong>${row[11] || ""} / ${row[12] || ""}</strong></td></tr>
      <tr><td>6</td><td>Date of Birth (as per Admission Register)</td><td><strong>${row[3] || ""}</strong></td></tr>
      <tr><td>7</td><td>Class in which the Student last studied in ( In figures)</td><td><strong>${row[17] || ""}</strong></td></tr>
      <tr><td>8</td><td>School/Board/Anual Examination last taken with result:</td><td><strong>BABA SCHOLARS ACADEMY /PASS/${row[17] || ""}</strong></td></tr>
      <tr><td>9</td><td>Subjects Studied</td><td><strong>${row[18] || ""}</strong></td></tr>
      <tr><td>10</td><td>Total Students Present on Opening Day</td><td><strong>${row[19] || ""}</strong></td></tr>
      <tr><td>11</td><td>General Conduct</td><td><strong>${row[23] || ""}</strong></td></tr>
      <tr><td>12</td><td>Date of Application for Certificate</td><td><strong>${row[20] || ""}</strong></td></tr>
      <tr><td>13</td><td>Date of Issuing Certificate</td><td><strong>${row[21] || ""}</strong></td></tr>
      <tr><td>14</td><td>Reason for Leaving</td><td><strong>${row[22] || ""}</strong></td></tr>
      <tr><td>15</td><td>Any other remarks:</td><td><strong>${row[23] || ""}</strong></td></tr>
    </table> 
  `;
  document.getElementById("studentTCInfo").innerHTML = tableHTML;
}

document.getElementById("studentTCDropdown").addEventListener("change", function () {
  const selectedValue = this.value;
  const matchedRow = allData.find(row => row[0] === selectedValue);
  if (matchedRow) {
    generateTCTable(matchedRow);
  } else {
    document.getElementById("studentTCInfo").innerHTML = "";
  }
});




function printCertificate() {
  const selectedValue = document.getElementById("studentTCDropdown").value;
  const matchedRow = allData.find(row => row[0] === selectedValue);

  if (!matchedRow) {
    alert("Please select a student to print the certificate.");
    return;
  }

  const originalTitle = document.title;
  const printTitle = `${matchedRow[0] || "TC"}-${matchedRow[2] || "Student"}`;
  document.title = printTitle;

  const printContents = document.querySelector('.certificate').outerHTML;
  const printWindow = window.open('', '', 'height=900,width=800');

  printWindow.document.write(`
    <html>
      <head>
        <title>${printTitle}</title>
        <style>
          body {
            font-family: Arial, Helvetica, sans-serif;
            padding: 40px;
            background: #fff;
          }
          .certificate {
            max-width: 900px;
            margin: auto;
            padding: 40px;
            border: 4px double #000;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
          }
          .headerTC {
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 30px;
          }
          .headerTC h1 {
            margin: 0;
            font-size: 28px;
            letter-spacing: 1px;
          }
          .headerTC h2 {
            margin: 5px 0;
            font-size: 18px;
          }
          .headerTC p {
            margin: 4px;
            font-size: 15px;
          }
           .titleTC {
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      margin: 30px 0 20px;
      text-decoration: underline;
    }
          .info-table {
            border: 1px solid #000;
            border-collapse: collapse;
            width: 100%;
            font-size: 16px;
          }
          .info-table td, .info-table th {
            border: 1px solid #000;
            padding: 6px 10px;
            vertical-align: top;
          }
          .signature-section {
            margin-top: 50px;
            display: flex;
            justify-content: space-between;
          }
          .signature {
            width: 45%;
            text-align: center;
            font-size: 15px;
          }
          .signature-line {
            margin-top: 60px;
            border-top: 1px solid #000;
            width: 80%;
            margin-left: auto;
            margin-right: auto;
          }
        </style>
      </head>
      <body onload="window.print(); window.close();">
        ${printContents}
      </body>
    </html>
  `);

  printWindow.document.close();

  // Restore original title after print (for browser tab)
  setTimeout(() => {
    document.title = originalTitle;
  }, 1000);
}



// last tc no view
function getHighestTCNumber() {
  const validRows = allData
    .filter(row => row[15] && row[15].trim() !== "") // Filter rows with non-empty TC number
    .map(row => ({
      tcNumber: parseInt(row[15].trim(), 10),
      aValue: row[0],
      cValue: row[2],
    }))
    .filter(item => !isNaN(item.tcNumber)); // Ensure tcNumber is valid

  if (validRows.length === 0) {
    document.getElementById("lastTCNumber").textContent = "No TC numbers available.";
    return;
  }

  // Find the row with max TC number
  const highest = validRows.reduce((prev, curr) => {
    return curr.tcNumber > prev.tcNumber ? curr : prev;
  });

  // Set output with line break
  document.getElementById("lastTCNumber").innerHTML =
    `Last Issued TC Number: ${highest.tcNumber}<br/>A No. ${highest.aValue} (${highest.cValue})`;
}

//


// Fetch on page load
fetchTCdata();
</script>

</body>
</html>
<!-- Transfer Certificate script and code stop-->











<!-- Report Card Summry section 6 code start-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BSA Marksheet</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 90%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        table, th, td {
            border: 1px solid grey;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        .markEsheet {
            margin-top: 30px;
            padding: 15px;
            border: 1px solid #fcf8f8;
            background-color: #f9f9f9;
        }
        .markEsheet h2 {
            text-align: center;
        }
        .formE-container {
            margin-bottom: 20px;
        }
        .formE-container input {
            margin-right: 10px;
            padding: 5px;
        }
        .error {
            color: red;
            font-size: 14px;
        }
        #printEButton {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background: #007BFF;
            color: white;
            border: none;
            cursor: pointer;
        }
    </style>
</head>
<body>

   

    <script>
    let sheetRCSdata = []; // Store fetched data

async function marksheetRCSload() {
    const apiRCSKey = "AIzaSyCerUAdaqNQ7mxjgNBbAeiHDEKgN0Dzoao";
    const sheetRCSId = "1S1mlCNs5Uq_3Sv5IR3OpdQusYl8GVKE5KCCvV8gQkw8";
    const rangeRCS = 'INDEX!A:AS';

    try {
        const response = await fetch(
            `https://sheets.googleapis.com/v4/spreadsheets/${sheetRCSId}/values/${rangeRCS}?key=${apiRCSKey}`
        );
        const data = await response.json();

        if (data.values) {
            sheetRCSdata = data.values;
            console.log("Data Loaded Successfully:", sheetRCSdata);
        } else {
            console.error("No data found in the specified range.");
        }
    } catch (error) {
        console.error("Error fetching data from Google Sheets:", error);
    }
}

function updateRCSDropdown() {
    const selectedClass = document.getElementById("ReportClassSummry").value.trim();
    const selectedSession = document.getElementById("ReportSummrySession").value.trim();
    const admissionDropdown = document.getElementById("ANOReport");

    //
    const studentCountDiv = document.getElementById("totalStudents");
    const topStudentDiv = document.getElementById("topStudent");

   // Initialize variables
let studentCount = 0; // Initialize studentCount
let topThree = []; // This array will hold the top results

admissionDropdown.innerHTML = '<option value="">Select Admission No</option>';

sheetRCSdata.forEach(row => {
    if (row[1]?.trim() === selectedClass && row[39]?.trim() === selectedSession) {
        // Create admission options dropdown
        let option = document.createElement("option");
        option.value = row[0];
        option.textContent = row[0];
        admissionDropdown.appendChild(option);

        // Increment the student count
        studentCount++;

        // Calculate the total marks for the current student
        let totalMarks = 0;
        const indexes = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 41, 42, 43, 44];

        for (let i of indexes) {
            totalMarks += isNaN(parseInt(row[i])) ? 0 : parseInt(row[i]);
        }

        // Push the current student's total marks to the topThree array
        topThree.push({
            name: row[2],
            admissionNo: row[0],
            totalMarks: totalMarks
        });
    }
});

// Sort the topThree array by totalMarks in descending order
topThree.sort((a, b) => b.totalMarks - a.totalMarks);

// Create the topResults string to show the top 5 students
let topResults = "";

if (topThree.length > 0) {
    topResults += `  <span style="color:#940227;font-size:80%;font-family:Arial;">1st: ${topThree[0].name} (Admission No: ${topThree[0].admissionNo}) (Total Marks: ${topThree[0].totalMarks}) </span> | `;
}
if (topThree.length > 1) {
    topResults += `    <span style="color:blue;font-size:80%;font-family:Arial;">  2nd: ${topThree[1].name} (Admission No: ${topThree[1].admissionNo}) (Total Marks: ${topThree[1].totalMarks}) </span>  | `;
}
if (topThree.length > 2) {
    topResults += ` <span style="color:red;font-size:80%;font-family:Arial;">  3rd: ${topThree[2].name} (Admission No: ${topThree[2].admissionNo}) (Total Marks: ${topThree[2].totalMarks}) </span> | `;
}
if (topThree.length > 3) {
    topResults += ` <span style="color:green;font-size:80%;font-family:Arial;">  4th: ${topThree[3].name} (Admission No: ${topThree[3].admissionNo}) (Total Marks: ${topThree[3].totalMarks}) </span> | `;
}
if (topThree.length > 4) {
    topResults += ` <span style="color:purple;font-size:80%;font-family:Arial;">  5th: ${topThree[4].name} (Admission No: ${topThree[4].admissionNo}) (Total Marks: ${topThree[4].totalMarks}) </span> `;
}

// Update the UI with the results
studentCountDiv.innerHTML = selectedClass ? `Total students in ${selectedClass}: <strong>${studentCount}</strong>` : "";
topStudentDiv.innerHTML = topResults;

}



function MarkRCSEsheet() {
    const admissionNo = document.getElementById("ANOReport").value.trim();
    const selectedClass = document.getElementById("ReportClassSummry").value.trim();
    const selectedSession = document.getElementById("ReportSummrySession").value.trim();
    const marksheetContent = document.getElementById("marksheetE-view");
    const errorMessage = document.getElementById("error-message");
    const printBSAButton = document.getElementById("printBSAButton");

    marksheetContent.innerHTML = "";
    errorMessage.textContent = "";
    printBSAButton.style.display = "none";

    if (!admissionNo || !selectedClass || !selectedSession) {
        errorMessage.textContent = "Please select Session, Class, and Admission No.";
        return;
    }

    let studentFound = false;
    const getValue = (val) => (val === undefined || val === null || val === "" ? "" : val);
    const getNumericValue = (val) => isNaN(parseInt(val)) ? 0 : parseInt(val);

    let maxMarks = 600;
    if (["3rd", "4th", "5th"].includes(selectedClass)) {
        maxMarks = 1400;
    } else if (["1st", "2nd"].includes(selectedClass)) {
        maxMarks = 1200;
    } else if (["UKG - B", "UKG - A", "UKG"].includes(selectedClass)) {
        maxMarks = 800;
    }

    const getSafeSum = (...values) => {
        let sum = 0;
        let hasValidValue = false;
        values.forEach(val => {
            const num = isNaN(parseInt(val)) ? 0 : parseInt(val);
            if (num !== 0) hasValidValue = true;
            sum += num;
        });
        return hasValidValue ? sum : "";
    };

     //  class position code start
    let topThree = [];
    for (let i = 1; i < sheetRCSdata.length; i++) {
        let row = sheetRCSdata[i];
        if (row[1] === selectedClass && row[39] === selectedSession) {
            let totalMarks = 0;
            let subjects = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 41, 42, 43, 44];

            subjects.forEach(index => {
                totalMarks += getNumericValue(row[index]);
            });

            const percentage = (totalMarks / maxMarks) * 100;
            topThree.push({
                name: row[2],
                admissionNo: row[0],
                totalMarks: totalMarks,
                percentage: percentage.toFixed(2)
            });
        }
    }

    // Step 2: Sort the students by total marks
    topThree.sort((a, b) => b.totalMarks - a.totalMarks);

    // Step 3: Find the position of the selected student (admissionNo) in the topThree array
    let position = "";
    topThree.forEach((student, index) => {
        if (student.admissionNo === admissionNo) {
            position = index === 0 ? "1st" : (index === 1 ? "2nd" : (index === 2 ? "3rd" : ""));
        }
    });

//  class position code stop

    // Step 4: Check if student exists and generate their marksheet
    for (let i = 1; i < sheetRCSdata.length; i++) {
        let row = sheetRCSdata[i];
        if (row[0] === admissionNo && row[1] === selectedClass && row[39] === selectedSession) {
            studentFound = true;
            let totalMarks = 0;
            let subjects = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 41, 42, 43, 44];

            subjects.forEach(index => {
                totalMarks += getNumericValue(row[index]);
            });

            //
const issueDateMap = {
    "2024-25": "29-Mar-2025",
    "2023-24": "27-Mar-2024",
    "2022-23": "20-Mar-2023"
};

const issueDate = issueDateMap[selectedSession] || "N/A"; // Default if no match

//

        //
        const newsessionBegin = {
    "2024-25": "04-Apr-25 at 7:35 AM",
    "2023-24": "04-Apr-24 at 7:45 AM",
    "2022-23": "01-May-2023"
};

const sessionBegin = newsessionBegin[selectedSession] || "N/A"; // Default if no match

//


            const percentage = (totalMarks / maxMarks) * 100;
            const roundedPercentage = percentage.toFixed(2);

            const grade =
                percentage >= 90 ? "A++" :
                percentage >= 80 ? "A+" :
                percentage >= 70 ? "A" :
                percentage >= 60 ? "B++" :
                percentage >= 50 ? "B+" :
                percentage >= 40 ? "B" :
                percentage >= 33 ? "C" :
                "Fail";

    
                    
     // Check if it's for UKG
     if (["UKG", "UKG - A", "UKG - B"].includes(selectedClass)) {
                    marksheetContent.innerHTML = `
                        
                        
<table class="marksheet-table">

                        
                        <table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: ${getValue(row[0])} </span> </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">ROLL NO. : ${row[6]} </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> PEN No: </span> ${row[7]} </td>

</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>


<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>




</tr>


<tr style="border: none;">  
<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Session:</strong> ${getValue(row[39])}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Total Marks:</strong> ${totalMarks}/${maxMarks}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Percentage:</strong> ${roundedPercentage}%</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;"><span style="color: white ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: #82e0aa ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>



</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center;font-weight: bold; color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>


<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Hindi Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">English Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[12]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[18]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[24]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[30]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[24], row[30])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18], row[24], row[30])} </span></td>
</tr>



<table style="width:100%"> 
<td style="background-color: #922b21 ;text-align: center;font-weight: bold; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>


</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>


                    `;


                } 

                else if (["Pre-Nursery"].includes(selectedClass)) {
                marksheetContent.innerHTML = `
                                        
<table class="marksheet-table">

                        
                        <table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: ${getValue(row[0])} </span> </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">ROLL NO. : ${row[6]} </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">CLASS & SEC. : </span> ${row[1]}</td>

</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>


<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>




</tr>


<tr style="border: none;">  
<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Session:</strong> ${getValue(row[39])}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Total Marks:</strong> ${totalMarks}/${maxMarks}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Percentage:</strong> ${roundedPercentage}%</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;"><span style="color: white ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: #82e0aa ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>



</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center;font-weight: bold; color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; ">
<tr style="border: none;">
<td style="background-color: #d5d8dc ;text-align: center ; color: WHITE ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: #d5d8dc ;text-align: center; color: WHITE ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
</tr>

<tr style="border: none;"> 
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">HINDI</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</tr>

<tr style="border: none;">
<td style="background-color: white ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">ENGLISH</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[9])}</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;border: none;"></td>
</tr>

<tr style="border: none;">
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">MATH</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[10])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</tr>

<tr style="border: none;">
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center ; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">DRAWING</td>
<td style="background-color: white ;text-align: center; color: balck ;font-family:Eras Bold ITC;">${getValue(row[11])}</td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
<td style="background-color: white ;text-align: center; color: balck ;border: none;"></td>
</tr>


<table style="width:100%: "> 
<td style="background-color: #922b21 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[12])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Oral</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[13])}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[15])}</td>
</tr>

</table>


                `;
            }
                
                else if (["NURSERY - A", "NURSERY - B", "LKG - A", "LKG - B"].includes(selectedClass)) {
                marksheetContent.innerHTML = `
                                        
<table class="marksheet-table">

                        
                        <table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: ${getValue(row[0])} </span> </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">ROLL NO. : ${row[6]} </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> PEN No: </span> ${row[7]} </td>

</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>


<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>




</tr>


<tr style="border: none;">  
<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Session:</strong> ${getValue(row[39])}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Total Marks:</strong> ${totalMarks}/${maxMarks}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Percentage:</strong> ${roundedPercentage}%</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;"><span style="color: white ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: #82e0aa ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>



</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center; font-weight: bold;color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>


<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">HINDI</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">ENGLISH</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>



<table style="width:100%: "> 
<td style="background-color: #922b21 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>



                `;
            }

            else if (["1st", "2nd"].includes(selectedClass)) {
            
                marksheetContent.innerHTML = `
                   
                                            
<table class="marksheet-table">

                        
                        <table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: ${getValue(row[0])} </span> </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">ROLL NO. : ${row[6]} </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> PEN No: </span> ${row[7]} </td>

</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>


<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>




</tr>


<tr style="border: none;">  
<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Session:</strong> ${getValue(row[39])}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Total Marks:</strong> ${totalMarks}/${maxMarks}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Percentage:</strong> ${roundedPercentage}%</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;"><span style="color: white ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: #82e0aa ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>



</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center; font-weight: bold; color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>

<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>


<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Hindi Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">English Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">E.V.S</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[11]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[17]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[23]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[29]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[23], row[29])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17], row[23], row[29])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[12]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[18]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[24]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[30]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[24], row[30])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18], row[24], row[30])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Computer</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[13]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[19]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[25]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[31]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[25], row[31])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19], row[25], row[31])}</span></td>
</tr>





<table style="width:100%: "> 
<td style="background-color: #922b21 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>


                `;
            }

            else {
                //  3rd, and 4th, 5th classes
                marksheetContent.innerHTML = `
                   
                                            
<table class="marksheet-table">

                        
                        <table style="width:100%; ">
                         <tr style="border: none;">  
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> ADMISSION NO: ${getValue(row[0])} </span> </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">ROLL NO. : ${row[6]} </td>

<td style="background-color: white ;text-align: center; color: balck ;border: none;font-family:Eras Bold ITC;font-weight: bold;">CLASS & SEC. : </span> ${row[1]}</td>
<td style="background-color: white ;text-align: RIGHT; color: balck ;border: none;"><span style="color: black ;font-size:100%; font-weight: bold;"> PEN No: </span> ${row[7]} </td>

</td>

</tr>
  
  <tr style="border: none;"> 
<td style="background-color: white ;text-align: left; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> NAME:  </span> ${row[2]} </td>


<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;">FATHER'S NAME: </span> ${row[3]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> MOTHER'S NAME: </span>${row[4]}</td>

<td style="background-color: white ;text-align: left ; color: balck ;border: none;"><span style="color: black ;font-size:90%; font-weight: bold;"> DATE OF BIRTH :  </span> ${row[5]} </td>




</tr>


<tr style="border: none;">  
<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Session:</strong> ${getValue(row[39])}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Total Marks:</strong> ${totalMarks}/${maxMarks}</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;border: none;"> <p><strong>Percentage:</strong> ${roundedPercentage}%</p></td>

<td style="background-color: #21618c ;text-align: left ; color: white ;"><span style="color: white ;font-size:95%; font-weight: bold;">Grade: ${grade} | Class Position: <span style="color: #82e0aa ;font-size:95%; font-weight: bold;"> ${position} </span>  </span>   </span></td>




</tr>
</table>

<span style="color: black ;font-size:95%; font-weight: bold;">TEACHER'S REMARKS:- </span>${row[37]}

<table style="width:100%"> 
<td style="background-color: #273746 ;text-align: center; font-weight: bold;color: white ;">ACADEMIC PERFORMANCE - FINAL TERM</td>
</td>
</table>

<table style="width:100%; background-color: black ;"> 
<tr> 
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECTS</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERMS-1</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">CLASS ASSESSMENT</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TERM-2</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
<td style="background-color: #d5d8dc ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">TOTAL</td>
</tr>

<tr> 
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">Max. Marks</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center ; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">30</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">70</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">100</td>
<td style="background-color: #eaecee ;text-align: center; color: balck ;font-weight: bold;">200</td>
</tr>


<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Hindi Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${getValue(row[8])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[14])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[20]}</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[26]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[20], row[26])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;"> ${getSafeSum(row[8], row[14], row[20], row[26])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">English Literature/ Language</td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[9]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[15]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"> ${row[21]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[27]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[21], row[27])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[9], row[15], row[21], row[27])}</span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">MATHEMATICS</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[10]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[16]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[22]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[28]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[22], row[28])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[10], row[16], row[22], row[28])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">E.V.S</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[11]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[17]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[23]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[29]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[23], row[29])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[11], row[17], row[23], row[29])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[12]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[18]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[24]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[30]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[24], row[30])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[12], row[18], row[24], row[30])} </span></td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Computer</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[13]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[19]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19])}</span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[25]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${row[31]}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[25], row[31])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[13], row[19], row[25], row[31])}</span></td>
</tr>


<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Sanskrit</td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[41])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[42])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[41], row[42])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;">${getValue(row[43])}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">${getValue(row[44])}</td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[43], row[44])} </span></td>
<td style="background-color: white ;text-align: center; color: balck ;"><span style="color: black ;font-size:95%; font-weight: bold;">${getSafeSum(row[41], row[42], row[43], row[44])} </span></td>
</tr>


<table style="width:100%: "> 
<td style="background-color: #922b21 ;text-align: center; color: white ;">CO- SCHOLASTIC PERFORMANCE -FINAL TERMS</td>
</td>
</table>
<table style="width:100%"> 
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">SUBJECT</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;font-family:Eras Bold ITC;font-weight: bold;">GRADE</td>
</tr>

<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Games</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[32]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Moral Values/ G.K</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[34]}</td>
</tr>
<tr> 
<td style="background-color: white ;text-align: left ; color: balck ;">Drawing</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[33]}</td>
<td style="background-color: white ;text-align: center ; color: balck ;">Cleanliness</td>
<td style="background-color: white ;text-align: center; color: balck ;">${row[35]}</td>
</tr>
<tr> 
<td style="background-color: #85929e ;text-align: left ; color: balck ;">Homework:</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">Regular</td>
<td style="background-color: #85929e ;text-align: center ; color: balck ;">Attendance :</td>
<td style="background-color: #85929e ;text-align: center; color: balck ;">${row[36]}</td>
</tr>
</table>

                `;
            }

            printBSAButton.style.display = "block";
            break;
        }
    }

    if (!studentFound) {
        errorMessage.textContent = "No student found with the given Admission No.";
    }
}


    
          
    
        function sheetRCSdataPrint() {
            const printWindow = window.open("", "_blank");
            const styles = `
                <style>
                body { font-family: Arial, sans-serif; margin: 20px;}
                
                 table {
                width: 100%;
                border-collapse: collapse;
                box-shadow: 0 0 15px rgba(0,0,0,0.1);
                background-color: #fff;
                margin-top: 20px;
                border-radius: 10px;
                overflow: hidden;
                font-size: 15px;
            }
    
            th, td {
                padding: 12px;
                border: 1px solid #ddd;
                text-align: center;
            }
    
            th {
                background: #0077b6;
                color: white;
                font-weight: bold;
                font-size: 15px;
            }

            </style>
            `;
    
            printWindow.document.write("<html><head><title>Student Marksheet</title></head><body>");
            printWindow.document.write(styles);
            printWindow.document.write(document.getElementById("marksheetE-view").outerHTML);
            printWindow.document.close();
            printWindow.print();
        }
    
    //  window.onload = function () {
//  marksheetRCSload();
 
//  };

  document.addEventListener("DOMContentLoaded", () => {
 
   marksheetRCSload();
});
    </script>
    
    
</body>
</html>


<!-- Report Card Summry section 6 code stop-->











